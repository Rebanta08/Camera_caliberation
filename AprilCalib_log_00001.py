# AprilCalib log 1
# CalibRig::mode=2d
# @ Wed Oct 21 13:05:11 2020

from numpy import array
U=array([[424.7707214355469, 501.4638671875, 400.8905639648438, 576.7680053710938, 650.954345703125, 474.1107177734375, 379.1423645019531, 546.181884765625, 723.8734741210938, 795.1546020507813, 617.556396484375, 449.3972778320313, 518.2421264648438, 687.9945068359375, 359.2188110351563, 864.849609375, 426.3303833007813, 757.113525390625, 932.577392578125, 586.7194213867188, 341.196533203125, 824.3968505859375, 493.2396240234375, 654.519287109375, 889.7188110351563, 558.7322998046875, 722.09716796875, 405.6902160644531, 623.8308715820313, 786.8930053710938, 470.225341796875, 850.0283813476563, 533.21630859375, 688.9022216796875, 595.60595703125, 751.9266967773438, 812.8565673828125, 657.99560546875, 719.12841796875, 778.6248779296875],
       [96.96279144287109, 133.2259674072266, 171.5832366943359, 169.4487762451172, 204.8119964599609, 205.9833984375, 240.0469055175781, 239.7731475830078, 239.7167816162109, 274.8668212890625, 272.8663024902344, 272.5933227539063, 304.3360900878906, 305.818603515625, 303.3549194335938, 309.0877380371094, 334.1932983398438, 338.8861694335938, 342.3941955566406, 335.9317016601563, 361.5950012207031, 371.1655883789063, 364.3305969238281, 367.2825927734375, 402.4925537109375, 394.7027282714844, 398.3077087402344, 390.5532836914063, 424.3125915527344, 428.7887573242188, 419.5482482910156, 457.9882507324219, 448.2036743164063, 453.3638610839844, 476.4361267089844, 481.6829223632813, 509.0668334960938, 503.8992919921875, 530.499267578125, 556.5696411132813]], dtype='float64');
Xw=array([[99.50446319580078, 299.5044555664063, 99.50446319580078, 499.5044555664063, 699.5044555664063, 299.5044555664063, 99.50446319580078, 499.5044555664063, 899.5044555664063, 1099.504516601563, 699.5044555664063, 299.5044555664063, 499.5044555664063, 899.5044555664063, 99.50446319580078, 1299.504516601563, 299.5044555664063, 1099.504516601563, 1499.504516601563, 699.5044555664063, 99.50446319580078, 1299.504516601563, 499.5044555664063, 899.5044555664063, 1499.504516601563, 699.5044555664063, 1099.504516601563, 299.5044555664063, 899.5044555664063, 1299.504516601563, 499.5044555664063, 1499.504516601563, 699.5044555664063, 1099.504516601563, 899.5044555664063, 1299.504516601563, 1499.504516601563, 1099.504516601563, 1299.504516601563, 1499.504516601563],
       [99.50446319580078, 99.50446319580078, 299.5044555664063, 99.50446319580078, 99.50446319580078, 299.5044555664063, 499.5044555664063, 299.5044555664063, 99.50446319580078, 99.50446319580078, 299.5044555664063, 499.5044555664063, 499.5044555664063, 299.5044555664063, 699.5044555664063, 99.50446319580078, 699.5044555664063, 299.5044555664063, 99.50446319580078, 499.5044555664063, 899.5044555664063, 299.5044555664063, 699.5044555664063, 499.5044555664063, 299.5044555664063, 699.5044555664063, 499.5044555664063, 899.5044555664063, 699.5044555664063, 499.5044555664063, 899.5044555664063, 499.5044555664063, 899.5044555664063, 699.5044555664063, 899.5044555664063, 699.5044555664063, 699.5044555664063, 899.5044555664063, 899.5044555664063, 899.5044555664063],
       [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]], dtype='float64');
# After LM:
K=array([[824.5167035074122, 0, 633.3088674391723],
       [0, 832.0890450992813, 360.5370713544193],
       [0, 0, 1]], dtype='float64');
distCoeffs=array([-0.154559846168552,
       0.381220119759078,
       0.004247691474438466,
       0.003117362512137256,
       0], dtype='float64');
CovK=array([[71.04957763097488, 90.65484834298768, -12.72994717079092, 2.637460797964922, -0.02537085604330623, 0.06223142084009003, 0.0004246081496772671, 0.00219636739706435, 0.4692612158920336],
       [90.65484834298269, 115.7303884445797, -16.28052947212884, 3.379563336303762, -0.03156869684838878, 0.07229153707310361, 0.0005452720396445044, 0.002806179912527074, 0.614446556740571],
       [-12.72994717079137, -16.28052947213007, 3.380793084905858, -0.4566633698746185, 0.003332054570774797, 0.002667602352966675, -7.280987229285522e-05, -5.665648312962295e-05, -0.1380280781717915],
       [2.637460797958544, 3.379563336295861, -0.4566633698750935, 0.6038048550966771, -0.0001670781671117854, -0.007609195571275628, 0.0001443830474166355, 9.179971794092796e-05, 0.05266387296318145],
       [-0.02537085604384772, -0.03156869684914181, 0.003332054570871862, -0.0001670781671302236, 0.0001426691251405595, -0.00143658862610191, -1.765163576351364e-07, -8.909933374849224e-07, 0.004144245256637468],
       [0.06223142084606983, 0.07229153708115305, 0.002667602351911075, -0.007609195571101467, -0.001436588626103574, 0.01579850082104124, 7.644077052816424e-07, 3.624824828218303e-06, -0.04931687107232698],
       [0.000424608149676749, 0.0005452720396436302, -7.280987229316989e-05, 0.0001443830474166272, -1.765163576322114e-07, 7.644077052563467e-07, 6.047000535590599e-08, 1.401186258254173e-08, 8.83343287007401e-07],
       [0.002196367397062773, 0.002806179912525406, -5.665648312933989e-05, 9.179971794156756e-05, -8.909933374666241e-07, 3.624824828025545e-06, 1.401186258268461e-08, 1.909449956828237e-07, 5.62934435441582e-06],
       [0.4692612158732553, 0.6144465567161054, -0.1380280781685313, 0.05266387296271065, 0.004144245256648985, -0.0493168710723907, 8.833432869501031e-07, 5.629344353833094e-06, 0.1652707453683267]], dtype='float64');
# rms=0.319349
r0=array([-0.4616125635172474,
       0.01161138338231488,
       -0.3080771981531065], dtype='float64');
t0=array([-953.9726713241761,
       -128.695062092704,
       2313.015428004239], dtype='float64');
Covr0=array([[2.660494735062772e-05, 3.663537386512238e-07, -2.920368120607896e-06],
       [3.66353738646693e-07, 1.583970753549649e-06, 2.690372448805461e-07],
       [-2.920368120608196e-06, 2.690372448802765e-07, 3.97545842232357e-07]], dtype='float64');
Covt0=array([[25.90757874588257, -2.02012520092147, 102.3161175845874],
       [-2.020125200925689, 4.321401907444295, -12.44216390955019],
       [102.3161175845688, -12.44216390959333, 567.417840394188]], dtype='float64');
r1=array([0.4957171746470412,
       0.0004307022932292204,
       0.4464138092653923], dtype='float64');
t1=array([-548.5761574812452,
       -746.1872385271988,
       1881.16283653934], dtype='float64');
Covr1=array([[2.937624132752541e-05, -3.021367888158203e-06, -3.641491147308143e-06],
       [-3.021367888155661e-06, 1.813971483284649e-06, 3.287607270702901e-08],
       [-3.641491147308718e-06, 3.287607270767355e-08, 5.489518223810044e-07]], dtype='float64');
Covt1=array([[17.37835562550821, 4.037566735372009, 67.49334647889486],
       [4.03756673536766, 4.18068458718053, 23.81237181799547],
       [67.49334647888351, 23.81237181796806, 378.4174746262248]], dtype='float64');
